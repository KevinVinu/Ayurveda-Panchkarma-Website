<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PanchaFlow • Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/dashboard.css">
</head> 
<body class="body">
    <div class="container">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="activity" class="sidebar-logo-icon"><path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"></path></svg>
                </div>
                <div>
                    <div class="sidebar-title">Ayursutra</div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a class="sidebar-nav-item active" href="#">
                    <span class="sidebar-nav-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="home" class="sidebar-nav-icon-svg"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path><path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>
                    </span>
                    <span class="sidebar-nav-text">Dashboard</span>
                </a>
                <a class="sidebar-nav-item" href="/patients?doctor_id=<%= doctor.doctor_id %>">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="users" class="sidebar-nav-icon-svg"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><path d="M16 3.128a4 4 0 0 1 0 7.744"></path><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><circle cx="9" cy="7" r="4"></circle></svg>
                    <span class="sidebar-nav-text">Patients</span>
                </a>
                <a class="sidebar-nav-item" href="/appointments?doctor_id=<%= doctor.doctor_id %>">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="calendar" class="sidebar-nav-icon-svg"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                    <span class="sidebar-nav-text">Appointments</span>
                </a>
                <a class="sidebar-nav-item" href="/therapy?doctor_id=<%= doctor.doctor_id %>">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="activity" class="sidebar-nav-icon-svg"><path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"></path></svg>
                    <span class="sidebar-nav-text">Therapy Tracking</span>
                </a>
                <a class="sidebar-nav-item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="trending-up" class="sidebar-nav-icon-svg"><path d="M16 7h6v6"></path><path d="m22 7-8.5 8.5-5-5L2 17"></path></svg>
                    <span class="sidebar-nav-text">Progress</span>
                </a>
                <a class="sidebar-nav-item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="bell" class="sidebar-nav-icon-svg"><path d="M10.268 21a2 2 0 0 0 3.464 0"></path><path d="M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326"></path></svg>
                    <span class="sidebar-nav-text">Notifications</span>
                </a>
                <a class="sidebar-nav-item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="message-square" class="sidebar-nav-icon-svg"><path d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"></path></svg>
                    <span class="sidebar-nav-text">Feedback</span>
                </a>
            </nav>

            <div class="sidebar-footer"></div>
        </aside>

        <!-- Main -->
        <div class="main-content">
            <!-- Top bar -->
            <header class="header">
                <div class="header-container">
                    <div class="header-left">
                        <button id="menuBtn" class="header-menu-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="panel-left-open" class="header-menu-icon"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M9 3v18"></path><path d="m14 9 3 3-3 3"></path></svg>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Content -->
            <main class="main">
                <div>
                    <h1 class="main-title">Welcome back, <%= doctor.name %></h1>
                    <p class="main-subtitle">Here's what's happening at your Panchakarma center today.</p>
                </div>

                <!-- Stats -->
                <section class="stats">
                    <div class="stats-card">
                        <div class="stats-card-content">
                            <div>
                                <div class="stats-card-title">Today's Appointments</div>
                                <div class="stats-card-value"><%= stats.appointments %></div>
                                <div class="stats-card-subtitle">
                                    <% const pendingAppointments = schedule.filter(apt => apt.status === 'pending').length; %>
                                    <%= pendingAppointments %> pending confirmations
                                </div>
                            </div>
                            <div class="stats-card-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="calendar" class="stats-card-icon-svg"><path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path></svg>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-card-content">
                            <div>
                                <div class="stats-card-title">Active Patients</div>
                                <div class="stats-card-value"><%= stats.patients %></div>
                                <div class="stats-card-subtitle">
                                    <% const newThisWeek = Math.floor(stats.patients * 0.12); %>
                                    <%= newThisWeek %> new this week
                                </div>
                            </div>
                            <div class="stats-card-icon patients">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="user-plus" class="stats-card-icon-svg"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><line x1="19" x2="19" y1="8" y2="14"></line><line x1="22" x2="16" y1="11" y2="11"></line></svg>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-card-content">
                            <div>
                                <div class="stats-card-title">Ongoing Therapies</div>
                                <div class="stats-card-value"><%= stats.therapies %></div>
                                <div class="stats-card-subtitle">Panchakarma sessions</div>
                            </div>
                            <div class="stats-card-icon therapies">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="activity" class="stats-card-icon-svg"><path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"></path></svg>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card">
                        <div class="stats-card-content">
                            <div>
                                <div class="stats-card-title">Success Rate</div>
                                <div class="stats-card-value"><%= stats.successRate %>%</div>
                                <div class="stats-card-subtitle">Patient satisfaction</div>
                            </div>
                            <div class="stats-card-icon success">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="trending-up" class="stats-card-icon-svg"><path d="M16 7h6v6"></path><path d="m22 7-8.5 8.5-5-5L2 17"></path></svg>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Schedule and Activity -->
                <section class="schedule-activity">
                    <!-- Schedule -->
                    <div class="schedule">
                        <div class="schedule-header">
                            <div class="schedule-header-content">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="clock" class="schedule-header-icon"><path d="M12 6v6l4 2"></path><circle cx="12" cy="12" r="10"></circle></svg>
                                <h2 class="schedule-header-title">Today's Schedule</h2>
                            </div>
                            <p class="schedule-header-subtitle">Upcoming appointments and sessions</p>
                        </div>

                        <div class="schedule-content">
                            <% if (schedule.length > 0) { %>
                                <% schedule.forEach(apt => { %>
                                    <div class="schedule-item">
                                        <div class="schedule-item-content">
                                            <div class="schedule-item-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="alarm-clock" class="schedule-item-icon-svg"><circle cx="12" cy="13" r="8"></circle><path d="M12 9v4l2 2"></path><path d="M5 3 2 6"></path><path d="m22 6-3-3"></path><path d="M6.38 18.7 4 21"></path><path d="M17.64 18.67 20 21"></path></svg>
                                            </div>
                                            <div>
                                                <div class="schedule-item-title"><%= apt.patient_name %></div>
                                                <div class="schedule-item-details"><%= apt.therapy_type %> · <span class="schedule-item-doctor"><%= apt.doctor_name %></span></div>
                                            </div>
                                        </div>
                                        <div class="schedule-item-time">
                                            <div class="schedule-item-time-text">
                                                <% const aptTime = new Date(apt.appointment_date); %>
                                                <%= aptTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true }) %>
                                            </div>
                                            <span class="schedule-item-status <%= apt.status %>"><%= apt.status %></span>
                                        </div>
                                    </div>
                                <% }); %>
                            <% } else { %>
                                <div class="schedule-item">
                                    <div class="schedule-item-content">
                                        <div>No appointments scheduled for today</div>
                                    </div>
                                </div>
                            <% } %>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="activity">
                        <div class="activity-header">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="waveform" class="activity-header-icon"><path d="M2 12h2l2-5 2 18 2-11 2 6 2-5 2 4 2-3 2 10 2-7 2 3"></path></svg>
                            <h2 class="activity-header-title">Recent Activities</h2>
                        </div>
                        <div class="activity-content">
                            <% if (activities.length > 0) { %>
                                <% activities.forEach(activity => { %>
                                    <div class="activity-item">
                                        <div class="activity-item-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="check-circle-2" class="activity-item-icon-svg"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>
                                        </div>
                                        <div class="activity-item-content">
                                            <div class="activity-item-title"><%= activity.activity_type %></div>
                                            <div class="activity-item-time">
                                                <% const activityTime = new Date(activity.created_at); %>
                                                <%= activityTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true }) %> · 
                                                <%= activityTime.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) %>
                                            </div>
                                        </div>
                                    </div>
                                <% }); %>
                            <% } else { %>
                                <div class="activity-item">
                                    <div class="activity-item-content">
                                        <div class="activity-item-title">No recent activities</div>
                                    </div>
                                </div>
                            <% } %>
                        </div>
                    </div>
                </section>

                <!-- Footer note -->
                <div class="footer-note">
                    <div class="footer-note-card">
                        <div class="footer-note-title">Tip</div>
                        <p class="footer-note-text">Keep patient history updated before therapy sessions to improve outcomes.</p>
                    </div>
                </div>
            </main>

            <!-- Floating help -->
            <button class="help-button">
                <span class="sr-only">Help</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="help-circle" class="help-button-icon"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg>
            </button>
        </div>
    </div>

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="/dashboard.js"></script>
</body>
</html>